# CLAUDE.md 开发准则

## 概览

本文件用于指导在当前仓库内进行的全部开发与文档工作，确保输出遵循强制性标准并保持可审计性。

**上下文信息要求**
- 在编码前至少分析 3 个现有实现或模式，识别可复用的接口与约束。
- 绘制依赖与集成点，确认输入输出协议、配置与环境需求。
- 弄清现有测试框架、命名约定和格式化规则，确保输出与代码库保持一致。
- **优先使用 context7 查询编程库文档**，避免过度依赖网页搜索或猜测。
- **使用 github.search_code 搜索开源实现示例**，学习最佳实践。
- **使用 desktop-commander 进行本地文件分析和数据处理**，绝对优先于bash命令。

**语言使用强制规范**
- ⚠️ **绝对强制使用简体中文**：所有 AI 回复、文档、注释、日志、提交信息等一切可使用任意语言的内容，必须强制使用简体中文。
- 唯一例外：代码标识符（变量名、函数名、类名等）遵循项目既有命名约定。
- 违反此规范的任何输出必须立即重写为简体中文。
- 所有文件使用 **UTF-8（无 BOM）** 编码。


### 📁 测试与调试文件目录规范

* 所有由 Claude Code 或任何自动化工具生成的  **调试代码、测试代码、临时输出文件、日志片段、数据快照、临时验证脚本** ，必须统一存放在项目根目录下的 `test/` 目录中。
* 目录结构建议如下：
  <pre class="overflow-visible!" data-start="332" data-end="657"><div class="contain-inline-size rounded-2xl relative bg-token-sidebar-surface-primary"><div class="sticky top-9"><div class="absolute end-0 bottom-0 flex h-9 items-center pe-2"><div class="bg-token-bg-elevated-secondary text-token-text-secondary flex items-center gap-4 rounded-sm px-2 font-sans text-xs"></div></div></div><div class="overflow-y-auto p-4" dir="ltr"><code class="whitespace-pre!"><span><span><project>/
      ├── src/                 ← 主代码目录
      ├── </span><span>test</span><span>/                ← 测试与调试目录（强制）
      │    ├── tmp/            ← 临时文件（自动生成）
      │    ├── debug/          ← 调试脚本或日志
      │    ├── results/        ← 测试结果、验证输出
      │    └── mock_data/      ← 测试输入数据
      └── .claude/             ← Claude 专用上下文与报告文件
  </span></span></code></div></div></pre>
* 任何生成测试或验证用途的文件，不得出现在除 `test/` 或 `.claude/` 外的路径中。
* 若确需写入其他目录（如测试依赖代码路径），必须：
  1. 在 `operations-log.md` 中记录理由；
  2. 提供回滚或清理脚本；
  3. 在任务结束后自动清除临时文件。

## 🧪 验证与执行原则
- 优先本地验证（单元测试、冒烟测试等）；  
- **允许与 GitHub Actions、Cursor、RPA 协作**；  
- 验证失败时应中止提交并记录原因；  
- 所有验证日志、报告输出至 `.claude/verification-report.md`。

## 💡 开发哲学（强制遵循）

- 必须坚持渐进式迭代，保持每次改动可编译、可验证
- 必须在实现前研读既有代码或文档，吸收现有经验
- 必须保持务实态度，优先满足真实需求而非理想化设计
- 必须选择表达清晰的实现，拒绝炫技式写法
- 必须偏向简单方案，避免过度架构或早期优化
- 必须遵循既有代码风格，包括导入顺序、命名与格式化

### 简单性定义

- 每个函数或类必须仅承担单一责任
- 禁止过早抽象；重复出现三次以上再考虑通用化
- 禁止使用"聪明"技巧，以可读性为先
- 如果需要额外解释，说明实现仍然过于复杂，应继续简化

## ⚠️ 禁止事项
- 跳过验证直接提交。  
- 使用非简体中文输出。  
- 将调试或临时文件写入 `src/` 或 `public/` 等目录。  
- 引入未经审查的外部库或工具。  

## ⚠️ 重要提醒

**绝对禁止：**

- 在缺乏证据的情况下做出假设，所有结论都必须援引现有代码或文档

**必须做到：**

- 在实现复杂任务前完成详尽规划并记录
- 对跨模块或超过 5 个子任务的工作生成任务分解
- 对复杂任务维护 TODO 清单并及时更新进度
- 在开始开发前校验规划文档得到确认
- 保持小步交付，确保每次提交处于可用状态
- 在执行过程中同步更新计划文档与进度记录
- 主动学习既有实现的优缺点并加以复用或改进
- 连续三次失败后必须暂停操作，重新评估策略

## 🎯 内容唯一性规则

- 每一层级必须自洽掌握自身抽象范围，禁止跨层混用内容
- 必须引用其他层的资料而非复制粘贴，保持信息唯一来源
- 每一层级必须站在对应视角描述系统，避免越位细节
- 禁止在高层文档中堆叠实现细节，确保架构与实现边界清晰
